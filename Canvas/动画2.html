<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title></title>
    </head>
    <body>
        <canvas id="canvas" width="300" height="300"></canvas>
        <button type="button" name="button" class="start">开始</button>
        <button type="button" name="button" class="stop">暂停</button>
        <script>

            const $ = (el) => document.querySelector(el)
            const canvas = $('#canvas')
            const start = $('.start')
            const stop = $('.stop')
            const ctx = canvas.getContext('2d')
            canvas.width = $('body').getBoundingClientRect().width
            ctx.fillStyle='red'
            let isPlay = false
            let x = 0
            start.addEventListener('click',function(){
                if(isPlay){
                    return
                }
                isPlay = true
                animate()
            })
            stop.addEventListener('click',function(){
                if(!isPlay){
                    return
                }
                isPlay = false
                animate()
            })
            function animate(){
                var arr = []
                for(var i=0;i<100;i++){
                    arr.push({
                        x:Math.random()*canvas.width,
                        y:Math.random()*250,
                        w:Math.random()*15,
                        h:Math.random()*15
                    })
                }
                if(isPlay){
                    ctx.clearRect(0,0,canvas.width,canvas.height)
                    for(let i=0;i<arr.length;i++){
                        ctx.beginPath();
                        ctx.fillRect(arr[i].x,arr[i].y,arr[i].w,arr[i].w)
                        ctx.closePath()
                    }
                    setTimeout(animate,60)
                }
            }


        </script>
    </body>
</html>
